Should mostly be moved in stimulis_structure and io_module
